{% extends 'profileTemplate.html.twig' %}
{% block head %}
    {{ parent() }}
    <link rel="icon" href="{{ preload(asset('assets/img/favicon/cropped-cropped-logo-trust-and-market-32x32.png')) }}"
          sizes="32x32"/>
    <link rel="icon" href="{{ preload(asset('assets/img/favicon/cropped-cropped-logo-trust-and-market-192x192.png')) }}"
          sizes="192x192"/>
    <link rel="apple-touch-icon-precomposed"
          href="{{ preload(asset('assets/img/favicon/cropped-cropped-logo-trust-and-market-180x180.png')) }}"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="msapplication-TileImage"
          content="{{ preload(asset('assets/img/favicon/cropped-cropped-logo-trust-and-market-270x270.png')) }}"/>
    <meta name="robots" content="noindex">
{% endblock %}

{% block title %}Trust&amp;Market | Profil Tableau de bord{% endblock %}
{% block header %}
    {{ parent() }}
    <style>
        .image_picker_image {
            width: 100px;
            height: 100px
        }

        .tox-statusbar__branding {
            display: none;
        }

        .btn-bg-primary {
            color: #fff;
            background: #f17b30 !important;
        }

        .btn-bg-primary:hover {
            color: #fff;
            background: #f4b279 !important;
        }

        user-info-text {
            font-size: 14px;
            font-family: 'Source Sans Pro', "Helvetica Neue", Helvetica, Arial, sans-serif;
            word-break: break-word;
            color: black;
        }

        .image_area {
            position: relative;
        }

        img {
            display: block;
            max-width: 100%;
        }

        .preview {
            overflow: hidden;
            width: 160px;
            height: 160px;
            margin: 10px;
            border: 1px solid red;
            float: right;
        }

        .modal-lg {
            max-width: 1000px !important;
        }

        .overlay {
            position: absolute;
            bottom: 10px;
            left: 0;
            right: 0;
            background-color: rgba(255, 255, 255, 0.5);
            overflow: hidden;
            height: 0;
            transition: .5s ease;
            width: 100%;
        }

        .image_area:hover .overlay {
            height: 50%;
            cursor: pointer;
        }

        .text {
            color: #333;
            font-size: 20px;
            position: absolute;
            top: 50%;
            left: 50%;
            -webkit-transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .modal-title {
            font-family: "Source Sans Pro", "Helvetica Neue", Helvetica, Arial, sans-serif;
        }

        .modal-content {
            border-radius: 5px;
        }

        .modal-body {
            width: 95%;
            margin: auto;
        }

        .modal-footer {
            display: block;
        }

        .modal-footer .btn-warning {
            float: left;
            background-color: #262626 !important;
        }

        .modal-footer .btn-primary {
            float: right;
        }

        strong {
            font-weight: bold;
        }

        .cropper-container {
            width: 100%;
        }

        /* Extra small devices (portrait phones, less than 576px) */
        @media (max-width: 575.98px) {
            .preview {
                overflow: hidden;
                width: 200px;
                height: 200px;
                border: 1px solid red;
                margin: auto;
                float: none;
            }

            .image-bloc {
                margin-top: 25px;
            }
        }

        /* Small devices (landscape phones, 576px and up) */
        @media (min-width: 576px) and (max-width: 767.98px) {
            .modal-content {
                border-radius: 5px;
            }

            .modal-body {
                width: 95%;
                margin: auto;
            }

            .modal-footer {
                display: block;
            }

            .modal-footer .cancel {
                float: left;
                font-size: large;
            }

            .modal-footer .approve {
                float: right;
                font-size: large;
            }

            .image-bloc {
                margin-top: 25px;
            }

            .preview {
                overflow: hidden;
                width: 200px;
                height: 200px;
                border: 1px solid red;
                margin: auto;
                float: none;
            }
        }

        @media only screen and(min-width: 992px) {
            .dashboard-menu {
                margin-top: 12px !important;
            }
        }
    </style>
{% endblock %}
	{% block style %}
        {{ parent() }}
        <link href="{{ preload(asset('assets/css/custome.css')) }}" rel="stylesheet">
        <link href="{{ absolute_url(asset('assets/css/style.css')) }}" rel="stylesheet">
        <link href="{{ preload(asset('assets/css/style-profile.css')) }}" rel="stylesheet">
        <!-- Custom css for input tag -->
        <link rel="stylesheet" href="{{ preload(asset('assets/css/tagsinput/tagify.css')) }}">
        <link rel="stylesheet" href="{{ asset('toastr/toastr.min.css') }}">
        <link rel="stylesheet" href="{{ asset('admin/assets/css/loading-btn.css') }}">
        <link rel="stylesheet" href="{{ asset('admin/assets/css/loading.css') }}">
        <link rel="stylesheet" href="{{ asset('assets/phone/css/intlTelInput.css') }}">
        <link rel="stylesheet" href="{{ asset('admin/assets/sweetalert/sweetalert.css') }}">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>
        <!-- Custom css for camroll -->
        <link href="{{ asset('assets/css/camroll/camroll_slider.css') }}" rel="stylesheet" type="text/css">
        <!-- Crop css -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"
              integrity="sha512-cyzxRvewl+FOKTtpBzYjW6x6IAYUCZy3sGP40hn+DQkqeluGRCax7qztK2ImL64SA+C7kVWdLI6wvdlStawhyw=="
              crossorigin="anonymous" referrerpolicy="no-referrer"/>
        <!-- owl carousel css -->
        <link rel="stylesheet" type="text/css"
              href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
        <link rel="stylesheet" type="text/css"
              href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
    {% endblock %}


	{% block navigation %}
        {{ parent() }}
    {% endblock %}
	{% block body %}

<!--Main Layout-->
    <div class="flex-fill container">
        <main class="">
            <div class="container mt-2 pt-4">
                {% include 'menuProfile.html.twig' %}
                <div class="mt-3">
                    {% for message in app.flashes('notice') %}
                        <div class="col-md-12 alert alert-warning alert-dismissible fade show" role="alert">
                            <strong>{{ message }}</strong>
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    {% endfor %}
                    <!-- Lecture des infos -->
                    <div id="lectureInfo" class="row">
                        <div class="col-md-4 mb-2">
                            <img class="img-fluid m-auto" width="100% \9"
                                 src="{% if avatar %}{{ avatar }}{% else %}{{ asset('assets/img/profile/avatar-profile.png') }}{% endif %}"
                                 alt="">
                        </div>
                        <div class="col-md-4">
                            {# {{dump(last_name)}} #}
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.nom'|trans }}:
                                <span>{% if last_name is not null %}{{ last_name.metaValue }}{% endif %}</span>
                            </p>
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.prenom'|trans }}:
                                <span>{% if first_name is not null %}{{ first_name.metaValue }}{% endif %}</span>
                            </p>
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.sexe'|trans }}:
                                <span>{% if sexe is not null %}{{ sexe.metaValue|trans }}{% endif %}</span>
                            </p>
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.date-de-naissance'|trans }}
                                :
                                <span>{{ bdaytime|trim }}</span>
                            </p>
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.lieu-de-naissance'|trans }}
                                :
                                <span>{% if birth_place is not null %}{{ birth_place.metaValue|country_name }}{% endif %}</span>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.telephone'|trans }}:
                                <span>{% if telephone is not null %}{{ telephone.metaValue }}{% endif %}</span>
                            </p>
                            <p class="user-info-text">{{ 'profil-utilisateur.formulaire-profil.adresse-email'|trans }}:
                                <span>{{ app.user.getEmailCanonical() }}</span>
                            </p>
                        </div>

                        <div class="col-md-12 mt-4">
                            <!--Accordion wrapper-->
                            <div class="accordion md-accordion  mb-5" id="accordionEx" role="tablist"
                                 aria-multiselectable="true">
                                <!-- Accordion card -->
                                <div class="card">
                                    <!-- Card header -->
                                    <div class="card-header" role="tab">
                                        <a data-toggle="collapse" id="headingOne1" data-parent="#accordionEx"
                                           href="#collapseOne1" aria-expanded="true"
                                           aria-controls="collapseOne1">
                                            <h5 class="mb-0">
                                                <i class="fas fa-plus" style="font-size: 22px; color: black;"
                                                   id="accordion_address">{{ 'profil-utilisateur.formulaire-profil.adresses'|trans }}</i>
                                            </h5>
                                        </a>
                                    </div>

                                    <!-- Card body -->
                                    <div id="collapseOne1" class="collapse md-12" role="tabpanel"
                                         aria-labelledby="headingOne1" data-parent="#accordionEx">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h3 class="col-md-12">{{ 'profil-utilisateur.formulaire-profil.domicile'|trans }}</h3>

                                                    <div class="md-form">
                                                        <input disabled type="text"
                                                               class="form-control" {% if numeroNomRue_domicile is not null %} value="{{ numeroNomRue_domicile.metaValue }}"{% endif %}>
                                                        <label>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-numero-rue'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text"
                                                               class="form-control" {% if codePostal_domicile is not null %} value="{{ codePostal_domicile.metaValue }}"{% endif %}>
                                                        <label>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-code-postal'|trans }}</label>

                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text"
                                                               class="form-control" {% if ville_domicile is not null %} value="{{ ville_domicile.metaValue }}"{% endif %}>
                                                        <label for="ville">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-ville'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text" class="form-control"
                                                               value="{{ region }}">
                                                        <label for="region">{{ 'profil-utilisateur.formulaire-profil.region'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <span>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-pays'|trans }}</span>
                                                        <select disabled class="browser-default custom-select">
                                                            {% if pays_domicile is not null %}
                                                                <option
                                                                value="{{ pays_domicile.metaValue }}">{{ pays_domicile.metaValue|country_name }}</option>{% endif %}
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="vl"></div>

                                                <div class="col-md-6">
                                                    <h3 class="col-md-12">{{ 'profil-utilisateur.formulaire-profil.livraison'|trans }}</h3>

                                                    <div class="md-form">
                                                        <input disabled type="text" class="form-control"
                                                               value="{% if numeroNomRue_livraison is not null %}{{ numeroNomRue_livraison.metaValue }}{% endif %}">
                                                        <label for="numeroNomRue_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-numero-rue'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text" class="form-control"
                                                               value="{% if codePostal_livraison is not null %}{{ codePostal_livraison.metaValue }}{% endif %}">
                                                        <label for="codePostal_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-code-postal'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text" class="form-control"
                                                               value="{% if ville_livraison is not null %} {{ ville_livraison.metaValue }}{% endif %}">
                                                        <label for="ville_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-ville'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <input disabled type="text" class="form-control"
                                                               value="{{ region_livraison }}">
                                                        <label for="region_livraison">{{ 'profil-utilisateur.formulaire-profil.region'|trans }}</label>
                                                    </div>
                                                    <div class="md-form">
                                                        <span>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-pays'|trans }}</span>
                                                        <select disabled class="browser-default custom-select">
                                                            {% if pays_livraison is not null %}
                                                                <option
                                                                value="{{ pays_livraison.metaValue }}">{{ pays_livraison.metaValue|country_name }}</option>{% endif %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Accordion card -->
                            </div>
                            <!-- Accordion wrapper -->
                        </div>
                        <div class="offset-md-6 col-md-6 text-right">
                            <div class="row">
                                <div class="col">
                                    <button id="modifierProfile"
                                            class="btn btn-md btn-primary">{{ 'profil-utilisateur.formulaire-profil.bouton-modifier'|trans }}</button>
                                </div>
                                <div class="col">
                                    <button id="deleteProfile" data-toggle="modal"
                                            data-target="#deleteTarget" {# href="{{path('profile_app_delete_profil',{'id':app.user.id})}}" #}
                                            class="btn btn-md btn-danger float-right">{{ 'profil-utilisateur.formulaire-profil.bouton-supprimer'|trans }}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Fin de lecture -->

                    <!-- Modif des infos -->
                    <div id="modifInfo">
                        <form class="row" action="{{ path('profile_updateProfile') }}" method="post" id="updateProfile"
                              enctype="multipart/form-data">
                            <div hidden class="col-md-12 alert alert-warning alert-dismissible fade show" role="alert">
                                <strong>Holy guacamole!</strong>
                                You should check in on some of those fields below.
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="col-md-4 mb-2" style="padding: 0px 35px;">
                                <div id="blah">
                                    <img class="img-fluid m-auto avatar-preview" id="avatar-preview" width="100% \9"
                                         src="{% if avatar %}{{ avatar }}{% else %}{{ asset('assets/img/profile/avatar-profile.png') }} {% endif %}">
                                </div>
                                <div class="custom-file">
                                    <label class="custom-file-label" for="imageUpload">
                                        <small>{{ 'profil-utilisateur.formulaire-profil.ajouter-photo-profil'|trans }}</small>
                                    </label>
                                    <input type="file" class="custom-file-input is-valid" id="imageUpload" name="avatar"
                                           lang="{{ app.request.getLocale() }}"
                                           accept="image/x-png,image/gif,image/jpeg">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="md-form">
                                    <input type="text" id="last_name" required name="last_name" class="form-control"
                                           value="{% if last_name is not null %} {{ last_name.metaValue }} {% endif %}">
                                    <label for="last_name">{{ 'profil-utilisateur.formulaire-profil.nom'|trans }}
                                        *</label>
                                </div>
                                <input type="text" hidden value="" id="crop_image" name="crop_image">
                                <div class="md-form">
                                    <input type="text" id="first_name" required name="first_name" class="form-control"
                                           value="{% if first_name is not null %} {{ first_name.metaValue }} {% endif %}">
                                    <label for="prenom">{{ 'profil-utilisateur.formulaire-profil.prenom'|trans }}
                                        *</label>
                                    </label>
                                </div>
                                <div class="md-form">
                                    <select id="sexe" name="sexe" required class="browser-default custom-select">
                                        <option value="homme" {% if sexe and sexe.metaValue=='homme' %} selected {% endif %}>{{ 'general.homme'|trans }}</option>
                                        <option value="femme" {% if sexe and sexe.metaValue=='femme' %} selected {% endif %}>{{ 'general.femme'|trans }}</option>
                                        <option value="autre" {% if sexe and sexe.metaValue=='autre' %} selected {% endif %}>{{ 'general.autre'|trans }}</option>
                                    </select>
                                </div>
                                <div class="md-form">
                                    <input autocomplete="disabled" type="text" id="bdaytime"
                                           style="font-size:14px; margin-top:20px" required name="bdaytime"
                                           class="form-control form-control-md inputNaissance"
                                           value="{{ bdaytime|trim }}">
                                    <label for="bdaytime">{{ 'profil-utilisateur.formulaire-profil.date-de-naissance'|trans }}
                                        *</label>
                                </div>
                                <div class="md-form">
                                    <select id="birth_place" name="birth_place" required
                                            class="browser-default custom-select">
                                        <option value="{% if birth_place and birth_place.metaValue is not null %} {{ birth_place.metaValue }}{% else %}{% endif %}">
                                            {% if birth_place and birth_place.metaValue is not null %}
                                            {{ birth_place.metaValue|country_name }}
                                            {% else %}
                                            {{ 'general.birth_place'|trans }}</option>
                                        {% endif %}
                                        {% include("countryRegister.html.twig") %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">

                                <div class="md-form">
                                    <input type="text" id="telephone" name="telephone" class="form-control"
                                           value="{% if telephone is not null %}{{ telephone.metaValue }}{% endif %}">
                                    <label class="active"
                                           for="tel">{{ 'profil-utilisateur.formulaire-profil.telephone'|trans }}</label>
                                </div>

                                <div class="md-form">
                                    <input type="email" id="email" required name="email" class="form-control"
                                           value="{{ app.user.getEmailCanonical() }}">
                                    <label for="email">{{ 'profil-utilisateur.formulaire-profil.adresse-email'|trans }}
                                        *</label>
                                    </label>
                                </div>
                            </div>

                            <div class="col-md-12 mt-4">
                                <!--Accordion wrapper-->
                                <div class="accordion md-accordion  mb-5" id="accordionEx2" role="tablist"
                                     aria-multiselectable="true">
                                    <!-- Accordion card -->
                                    <div class="card">
                                        <!-- Card header -->
                                        <div class="card-header" role="tab">
                                            <a data-toggle="collapse" id="headingOne2" data-parent="#accordionEx2"
                                               href="#collapseOne2" aria-expanded="true"
                                               aria-controls="collapseOne1">
                                                <h5 class="mb-0">
                                                    <i class="fas fa-plus" style="font-size: 22px; color: #000000;"
                                                       id="accordion_address2">{{ 'profil-utilisateur.formulaire-profil.adresses'|trans }}</i>
                                                </h5>
                                            </a>
                                        </div>

                                        <!-- Card body -->
                                        <div id="collapseOne2" class="collapse md-12" role="tabpanel"
                                             aria-labelledby="headingOne2" data-parent="#accordionEx2">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <h3 class="col-md-12">{{ 'profil-utilisateur.formulaire-profil.domicile'|trans }}</h3>
                                                        <div class="md-form">
                                                            <input type="text" id="numeroNomRue_domicile"
                                                                   name="numeroNomRue_domicile"
                                                                   class="form-control" {% if numeroNomRue_domicile is not null %} value="{{ numeroNomRue_domicile.metaValue }}" {% endif %}>
                                                            <label for="numeroNomRue_domicile">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-numero-rue'|trans }}</label>
                                                        </div>
                                                        <div class="md-form">
                                                            <input type="text" id="codePostal_domicile"
                                                                   name="codePostal_domicile"
                                                                   class="form-control" {% if codePostal_domicile is not null %} value="{{ codePostal_domicile.metaValue }}" {% endif %}>
                                                            <label for="codePostal_domicile">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-code-postal'|trans }}</label>
                                                        </div>
                                                        <div class="md-form">
                                                            <input type="text" id="ville_domicile" name="ville_domicile"
                                                                   class="form-control" {% if ville_domicile is not null %} value="{{ ville_domicile.metaValue }}" {% endif %}>
                                                            <label for="ville_domicile">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-ville'|trans }}</label>
                                                        </div>

                                                        <div class="md-form">
                                                            <input type="text" id="region" name="region"
                                                                   class="form-control" value="{{ region }}">
                                                            <label for="region">{{ 'profil-utilisateur.formulaire-profil.region'|trans }}</label>
                                                        </div>

                                                        <div class="md-form">
                                                            <span>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-pays'|trans }}</span>
                                                            <select id="pays_domicile" name="pays_domicile"
                                                                    class="browser-default custom-select">
                                                                {% if pays_domicile is not null %}
                                                                    <option
                                                                    value="{{ pays_domicile.metaValue }}">{{ pays_domicile.metaValue|country_name }}</option>{% endif %}
                                                                {% include 'countryRegister.html.twig' %}
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="vl"></div>

                                                    <div class="col-md-6">
                                                        <h3 class="col-md-12">{{ 'profil-utilisateur.formulaire-profil.livraison'|trans }}</h3>
                                                        <div class="md-form">
                                                            <input type="text" id="numeroNomRue_livraison"
                                                                   name="numeroNomRue_livraison"
                                                                   class="form-control" {% if numeroNomRue_livraison is not null %} value="{{ numeroNomRue_livraison.metaValue }}" {% endif %}>
                                                            <label for="numeroNomRue_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-numero-rue'|trans }}</label>
                                                        </div>
                                                        <div class="md-form">
                                                            <input type="text" id="codePostal_livraison"
                                                                   name="codePostal_livraison"
                                                                   class="form-control" {% if codePostal_livraison is not null %} value="{{ codePostal_livraison.metaValue }}" {% endif %}>
                                                            <label for="codePostal_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-code-postal'|trans }}</label>
                                                        </div>
                                                        <div class="md-form">
                                                            <input type="text" id="ville_livraison"
                                                                   name="ville_livraison"
                                                                   class="form-control" {% if ville_livraison is not null %} value="{{ ville_livraison.metaValue }}" {% endif %}>
                                                            <label for="ville_livraison">{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-ville'|trans }}</label>
                                                        </div>

                                                        <div class="md-form">
                                                            <input type="text" id="region_livraison"
                                                                   name="region_livraison"
                                                                   class="form-control" value="{{ region_livraison }}">
                                                            <label for="region_livraison">{{ 'profil-utilisateur.formulaire-profil.region'|trans }}</label>
                                                        </div>

                                                        <div class="md-form">
                                                            <span>{{ 'profil-utilisateur.fournisseurs.formulaire-details-facture-pays'|trans }}</span>
                                                            <select id="pays_livraison" name="pays_livraison"
                                                                    class="browser-default custom-select">
                                                                {% if pays_livraison is not null %}
                                                                    <option
                                                                    value="{{ pays_livraison.metaValue }}">{{ pays_livraison.metaValue|country_name }}</option>{% endif %}
                                                                {% include 'country.html.twig' %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Accordion card -->
                                </div>
                                <!-- Accordion wrapper -->
                            </div>
                            <div class="offset-md-6 col-md-6">
                                <div class="row">
                                    <div class="col">
                                        <button id="send" type="submit"
                                                class="btn btn-md btn-success ld-over-inverse ">{{ 'profil-utilisateur.formulaire-modification-profil.bouton-modifier'|trans }}
                                            <i class="ld ld-ring ld-spin"></i>
                                        </button>
                                    </div>
                                    <div class="col">
                                        <button id="annulerModif" type="button"
                                                class="btn btn-md btn-warning">{{ 'profil-utilisateur.formulaire-modification-profil.bouton-annuler'|trans }}</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <!-- Fin des modifs -->

                    <!-- Crop modal -->
                    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Redimensionner votre image et enregistrer</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">Ã—</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="img-container px-3">
                                        <div class="row">
                                            <div class="col-md-8" style="margin: inherit;">
                                                <img src="" id="sample_image"/>
                                            </div>
                                            <div class="col-md-4 image-bloc">
                                                <div class="preview"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-warning cancel" data-dismiss="modal">
                                        <b>Annuler</b></button>
                                    <button type="button" id="crop" class="btn btn-primary approve"><b>Enregistrer</b>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Crop modal -->
                </div>
            </div>
            {% include("partials/project.html.twig") %}
            {% include("partials/otherPagesVideoModal.html.twig") %}
        </main>
    </div><!--Main Layout-->{% endblock %}{% block footer %}{{ parent() }}<!-- Modal for supprimer -->
    <div class="modal fade right" id="deleteTarget" tabindex="-1" role="dialog" aria-labelledby="deleteTarget"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="row">
                    <div class="col-md-6 px-0" style="background: url(); background-size: cover">
                        <img src="{{ asset('assets/img/modal/img-log.png') }}" alt="" class="img-fluid"
                             style="width: fit-content">
                    </div>
                    <div class="col-md-6 px-0 right-section-modal">
                        <div class="modal-header border-bottom-0">
                            <h5 class="modal-title"
                                id="exampleModalPreviewLabel">{{ 'profil-utilisateur.liens.effacer-compte'|trans }}</h5>
                        </div>
                        <div class="modal-body">
                            <div class="effacer-definitivement">
                                <div>
                                    <input type="checkbox" id="horns" name="horns"/>
                                </div>
                                <div>
                                    <label for="horns">{{ 'profil-utilisateur.liens.effacer-compte-donnees'|trans }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer border-top-0 pb-0">
                            <div class="btn-group btn-group-lg" role="group" aria-label="Basic example">
                                <button type="button" class="btn btn-lg firstletter-capital logout-no"
                                        data-dismiss="modal">{{ 'general.non'|trans }}</button>
                                <button type="button"
                                        class="btn btn-lg btn-primary firstletter-capital logout-yes delete_port2">{{ 'general.oui'|trans }}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- Modal -->
<input id="hornsUrlDelete" hidden value="{{ path('profile_delete_profil',{id:id}) }}"/>
<input id="hornsUrlDeleteAll" hidden value="{{ path('profile_delete_profil_all',{id:id}) }}"/>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <!-- jQuery plugin for camroll slider -->
    <script type="text/javascript" src="{{ asset('assets/js/camroll/camroll_slider.js') }}">
    </script><!-- jQuery plugin for spartan image picker -->
    <script type="text/javascript"
            src="{{ asset('assets/js/spartan-image-picker/spartan-multi-image-picker-min.js') }}">
    </script><!-- jQuery plugin for input tags -->
    <script src="{{ prerender(asset('assets/js/tagsinput/jQuery.tagify.min.js')) }}"></script>
    <script src="{{ asset('toastr/toastr.min.js') }}"></script><!-- jQuery plugin for datepicker -->
    <script src="{{ asset('assets/js/gijgo-js/gijgo.min.2.js') }}"></script>
    <script src="{{ asset('assets/phone/js/intlTelInput.min.js') }}"></script>
    <script src="{{ asset('admin/assets/sweetalert/sweetalert.min.js') }}"></script><!-- Tinymce editor -->
    <!-- owl carousel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <!-- Crop cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"
            integrity="sha512-6lplKUSl86rUVprDIjiW8DuOniNX8UDoRATqZSds/7t6zCQZfaCe3e5zcGaQwxa8Kpn5RTM9Fvl3X2lLV4grPQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- cdnjs for lazy load -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.9/jquery.lazy.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.9/jquery.lazy.plugins.min.js"></script>
    <!-- cdnjs for lazy load -->
    <script>
        function validateEmail(email) {
            let re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        }

        function validatePhoneNumber(phone) {
            let re = /^(\+|00)[0-9]{1,3}[0-9 ]{4,20}(?:x.+)?$/;
            return re.test(phone);
        }

        $(document).ready(function () {
            let docWidth = document.documentElement.offsetWidth;
            [].forEach.call(document.querySelectorAll('*'), function (el) {
                if (el.offsetWidth > docWidth) {
                    console.log(el);
                }
            });

            // Lazy Loading initializer
            $(function () {
                $('.lazy').lazy();
            });
            $("[for=tel]").addClass("active");
            $('.inputNaissance').datepicker({
                uiLibrary: 'bootstrap4',
                size: 'large',
                showRightIcon: false,
                iconsLibrary: 'fontawesome',
                format: 'mm/dd/yyyy',
                label: false
            });

            // input tags
            //$('#competencesModif').tagify();

            // Hambuger menu icon
            $('.animated-button-icon').on('click', function () {
                $('.animated-icon2').toggleClass('open');
            });
            // first thing turn Hide Menu Search bar
            $("#searchMenu").hide();
            // toggle menu search bar on/off
            $("#searchMenuShowHide").click(function () {
                $("#searchMenu").toggle("slide");
            });

            // first thing turn Hide "Update section" input field
            // $("#lectureInfo").hide();
            $("#modifInfo").hide();

            // toggle on/off using "Mofier mon profile"
            $("#modifierProfile").click(function () {
                $("#lectureInfo").toggle("slide");
                $("#modifInfo").toggle("slide");
            });
            // toggle on/off using "Annuler les modification"
            $("#annulerModif").click(function () {
                $("#modifInfo").toggle("slide");
                $("#lectureInfo").toggle("slide");
            });

            $("div[role='wrapper']").append("<div class='valid-feedback'>OK!</div><div class='invalid-feedback'>Ce champ contient une erreur!</div>");

            // Validate fields
            // First Name
            $("#first_name").change(function () {
                let prenom = $("#first_name").val();
                if (isNaN(prenom)) {
                    $("#first_name").removeClass("is-invalid");
                    $("#first_name").addClass("is-valid");
                } else {
                    $("#first_name").removeClass("is-valid");
                    $("#first_name").addClass("is-invalid");
                }
            });

            // Last Name
            $("#last_name").change(function () {
                let prenom = $("#last_name").val();
                if (isNaN(prenom)) {
                    $("#last_name").removeClass("is-invalid");
                    $("#last_name").addClass("is-valid");
                } else {
                    $("#last_name").removeClass("is-valid");
                    $("#last_name").addClass("is-invalid");
                }
            });

            $("#sexe").change(function () {
                let nom = $("#sexe").val();
                if (isNaN(nom)) {
                    $("#sexe").removeClass("is-invalid");
                    $("#sexe").addClass("is-valid");
                } else {
                    $("#sexe").removeClass("is-valid");
                    $("#sexe").addClass("is-invalid");
                }
            });


            $("#email").change(function () {
                let email = $("#email").val();

                if (validateEmail(email)) {
                    $("#email").removeClass("is-invalid");
                    $("#email").addClass("is-valid");
                } else {
                    $("#email").removeClass("is-valid");
                    $("#email").addClass("is-invalid");
                }

            });

            $("#telephone").change(function () {
                let phone = $("#telephone").val();
                if (validatePhoneNumber(phone)) {
                    $("#telephone").removeClass("is-invalid");
                    $("#telephone").addClass("is-valid");
                } else {
                    $("#telephone").removeClass("is-valid");
                    $("#telephone").addClass("is-invalid");
                }
            });

            $("#bdaytime").change(function () {
                let bdaytime = $("#bdaytime").val().replace(/\s|[a-zA-Z]/g, "");
                $("#bdaytime").val(bdaytime);
            });


            $("#raison_sociale").change(function () {
                let nom = $("#raison_sociale").val();
                if (isNaN(nom)) {
                    $("#raison_sociale").removeClass("is-invalid");
                    $("#raison_sociale").addClass("is-valid");
                } else {
                    $("#raison_sociale").removeClass("is-valid");
                    $("#raison_sociale").addClass("is-invalid");
                }
            });


            $("#region").change(function () {
                let nom = $("#region").val();
                if (isNaN(nom)) {
                    $("#region").removeClass("is-invalid");
                    $("#region").addClass("is-valid");
                } else {
                    $("#region").removeClass("is-valid");
                    $("#region").addClass("is-invalid");
                }
            });

            //Code postal livraison et domicile
            $("#codePostal_livraison").keyup(function () {
                let codePostal_livraison = $("#codePostal_livraison").val().replace(/\s/g, "");
                $("#codePostal_livraison").val(codePostal_livraison);
                if (codePostal_livraison != '') {
                    $("#codePostal_livraison").removeClass("is-invalid");
                    $("#codePostal_livraison").addClass("is-valid");
                } else {
                    $("#codePostal_livraison").removeClass("is-valid");
                    $("#codePostal_livraison").addClass("is-invalid");
                }
            });

            $("#codePostal_domicile").keyup(function () {
                let codePostal_domicile = $("#codePostal_domicile").val().replace(/\s/g, "");
                $("#codePostal_domicile").val(codePostal_domicile);
                if (codePostal_domicile != '') {
                    $("#codePostal_domicile").removeClass("is-invalid");
                    $("#codePostal_domicile").addClass("is-valid");
                    $("#codePostal_livraison").val(codePostal_domicile);
                    $("[for=codePostal_livraison]").addClass("active");
                } else {
                    $("#codePostal_domicile").removeClass("is-valid");
                    $("#codePostal_domicile").addClass("is-invalid");
                }
            });

            $("#ville_domicile").keyup(function () {
                $("#ville_livraison").val($("#ville_domicile").val());
                $("[for=ville_livraison]").addClass("active");
            });

            $("#region").keyup(function () {
                $("#region_livraison").val($("#region").val());
                $("[for=region_livraison]").addClass("active");
            });

            $("#numeroNomRue_domicile").keyup(function () {
                $("#numeroNomRue_livraison").val($("#numeroNomRue_domicile").val());
                $("[for=numeroNomRue_livraison]").addClass("active");
            });


            // Preview selected profile photo
            let $modal = $('#modal');
            let image = document.getElementById('sample_image');
            let crop_image = "";
            let cropper;
            document.getElementById('imageUpload').addEventListener('change', function (event) {
                let fileInput = event.target;
                let file = fileInput.files[0];
                let files = event.target.files;
                let message_size = '';
                if (fileInput.files.length !== 0 && file.size > 1048576) {
                    fileInput.value = "";
                    message_size = "{{ 'systeme.requetes.taille_fichier_avatar'|trans }}";
                    toastr.warning(message_size);
                } else if (fileInput.files.length !== 0 && file.size < 1048576) {
                    //Handle crop
                    var done = function (url) {
                        image.src = url;
                        $modal.modal('show');
                    };
                    reader = new FileReader();
                    reader.onload = function (event) {
                        done(reader.result);
                    };
                    reader.readAsDataURL(files[0]);
                }
            });

            $modal.on('shown.bs.modal', function () {
                cropper = new Cropper(image, {
                    aspectRatio: 1,
                    viewMode: 3,
                    preview: '.preview'
                });
            }).on('hidden.bs.modal', function () {
                cropper.destroy();
                cropper = null;
                $('#imageUpload').val('');
            });

            $('#crop').click(function () {
                canvas = cropper.getCroppedCanvas({
                    width: 400,
                    height: 400
                });

                canvas.toBlob(function (blob) {
                    url = URL.createObjectURL(blob);
                    let reader = new FileReader();
                    reader.readAsDataURL(blob);
                    reader.onloadend = function () {
                        let base64data = reader.result;

                        $('#blah').html('<img class="img-fluid m-auto avatar-preview" id="avatar-preview" style="max-height:400px" width="100%" src="' + url + '" >');
                        crop_image = base64data;
                        $modal.modal('hide');
                    };
                });
            });


            // Modification du profil de l'utilisateur
            // list images from portfolio and video

            $('#updateProfile').on('submit', function (e) { // On empï¿½che le navigateur de soumettre le formulaire
                e.preventDefault();
                $('#crop_image').val(crop_image);
                $('#telephone').val($('#telephone').val().replace(/\s/g, ''));
                $('#send').addClass('running');
                toastr.clear();
                toastr.info("{{ 'systeme.requetes.requete-en-cours'|trans }}");

                let $form = $(this);
                let formdata = (window.FormData) ? new FormData($form[0]) : null;
                let data = (formdata !== null) ? formdata : $form.serialize();

                $.ajax({
                    url: $form.attr('action'),
                    type: $form.attr('method'),
                    contentType: false,
                    processData: false,
                    data: data,
                    success: function (response) {
                        console.log(response)
                        if (response.result == 1) {
                            if (response.data.error) {
                                let errorMsg = response.data.error.message;
                                toastr.clear();
                                toastr.error("Erreur Stripe : " + errorMsg);
                            } else {
                                toastr.clear();
                                toastr.success('{{ 'systeme.requetes.succes'|trans }}');
                                window.location = "";
                            }
                        } else if (response.result == 0) {
                            $('#send').removeClass('running');
                            toastr.clear();
                            toastr.error("{{ 'systeme.requetes.erreur'|trans }}");
                        }
                    },
                    error: function (response) {
                        $('#send').removeClass('running');
                        toastr.clear();
                        toastr.error("{{ 'general.error'|trans }}");
                    }
                });
            });


            $(document).on('click', '.delete_port2', function (e) {
                var urlPath = '';
                e.preventDefault();
                toastr.info("{{ 'systeme.compte.en-cours'|trans }}");
                if ($('#horns:checkbox:checked').length > 0) {
                    urlPath = $("#hornsUrlDeleteAll").val();
                    console.log(urlPath);
                } else {
                    urlPath = $("#hornsUrlDelete").val();
                }

                $.ajax({
                    url: urlPath,
                    type: 'GET',
                    success: function (reponse) {
                        if (reponse == 1) {
                            console.log('true');
                            toastr.clear();
                            toastr.success("{{ 'systeme.compte.succes'|trans }}");
                            window.location = "/";
                        }
                    },
                    error: function (reponse) {
                        toastr.clear();
                        toastr.error("{{ 'systeme.compte.error'|trans }}");
                    }

                });
            });

            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": false,
                "progressBar": true,
                "positionClass": "toast-top-center",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "1600",
                "hideDuration": "1600",
                "timeOut": "2000",
                "extendedTimeOut": "2200",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            let input = document.querySelector("#telephone");
            window.intlTelInput(input, {
                autoHideDialCode: true,
                initialCountry: "fr",
                nationalMode: false,
                formatOnDisplay: false,
                // separateDialCode: true,
                utilsScript: "/assets/phone/js/utils.js"
            });
        });

    </script>

{% endblock %}
